<section *ngIf="!application" id="application" class="usa-section">
  <div class="usa-grid">
    <h1 id="skip-nav-target" tabindex="-1">Apply for a christmas tree permit.</h1>
    <h2 *ngIf="forest">{{forest.forestName}} National Forest</h2>

    <app-api-error *ngIf="apiErrors" [errors]="apiErrors"></app-api-error>

    <form [formGroup]="applicationForm" class="usa-form-large" novalidate (ngSubmit)="onSubmit()">
      <p class="form-directions">All form fields are required unless otherwise noted.</p>

      <div id="form-errors"
        *ngIf="(submitted && !applicationForm.valid)"
        class="usa-alert usa-alert-error" aria-live="assertive" aria-hidden="false" role="alert">
        <div class="usa-alert-body">
          <h3 class="usa-alert-heading">There are errors in your application.</h3>
          <p class="usa-alert-text">Please correct the errors before submitting.</p>
        </div>
      </div>

      <fieldset>
        <legend>Applicant information</legend>

          <div>
            <app-permit-holder-name [applicantInfo]="applicationForm"></app-permit-holder-name>
            <app-email [applicantInfo]="applicationForm"></app-email>
            <app-quantity [parentGroup]="applicationForm" label="Number of Christmas tree permits to purchase"></app-quantity>
            <label id="total-cost" class="usa-input">Cost for trees: <p>${{applicationForm.controls.totalCost.value}}</p></label>
        </div>
      </fieldset>

      <button id="submit-application" class="usa-button-primary-alt usa-button-big" type="submit">Submit your application.</button>

    </form>

  </div>
</section>

<section *ngIf="submitted === true && application" id="redirect-notice" aria-live="assertive" class="usa-section">
  <div class="usa-grid">
    <h1>Confirm and pay.</h1>
    <h2 *ngIf="forest">{{forest.forestName}} National Forest</h2>
    <h3>Order summary</h3>
    <p>Name: {{ application.firstName }} {{ application.lastName }}</p>
    <p>Email address: {{ application.emailAddress }}</p>
    <p>Number of trees: {{ application.quantity }}</p>
    <p>Total cost: ${{application.totalCost }}</p>
    <hr />
    <p>You will be redirected to Pay.gov in order to complete your transaction.</p>
    <a [routerLink]="['/christmas-trees/forests/', forest.forestAbbr,'tree-guidelines']" class="usa-button-outline usa-button usa-button-big">Cancel</a>
    <button class="usa-button-primary-alt usa-button-big">Checkout with <img class="pay-gov-logo" src="/assets/img/pay-gov.png" alt="Pay.gov" /></button>
  </div>
</section>
